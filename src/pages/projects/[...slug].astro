---
import { CollectionEntry, getCollection } from "astro:content";
import Layout from "../../layouts/Layout.astro";
import ProjectButtons from "../../components/ProjectButtons.astro";

export async function getStaticPaths() {
    const projectEntries = await getCollection("projects");
    return projectEntries.map((entry) => ({
        params: { slug: entry.slug },
        props: { entry },
    }));
}

const { entry } = Astro.props as { entry: CollectionEntry<"projects"> };
const { Content } = await entry.render();
const title = entry.data.title;
---

<Layout title={title}>
    <section class="max-w-[65ch] w-4/5 my-12">
        <h1 class="text-3xl font-bold mt-4">{entry.data.title}</h1>
        <span class="block w-full border-t border-dotted mt-4"></span>
        {
            entry.data.awards != null &&
            entry.data.awards != undefined &&
            entry.data.awards.length != 0 ? (
                <div class="mt-4 text-sm">
                    <span class="font-bold">Awarded:</span>{" "}
                    {entry.data.awards.map((award, index) => {
                        const builder = [];
                        builder.push(award);
                        if (index != entry.data.awards!.length - 1) {
                            builder.push(", ");
                        }
                        return builder.join("");
                    })}
                </div>
            ) : null
        }
        {
            entry.data.tech.length != 0 ? (
                <div class="mt-2 text-sm">
                    <span class="font-bold ">Technologies:</span>{" "}
                    {entry.data.tech.map((tech, index) => {
                        const builder = [];
                        builder.push(tech);
                        if (index != entry.data.tech.length - 1) {
                            builder.push(", ");
                        }
                        return builder.join("");
                    })}
                </div>
            ) : null
        }
        <img
            class="w-fit mt-4"
            crossorigin="anonymous"
            src={entry.data.image}
            alt={`${entry.data.title} project image`}
        />
        <div class="w-full flex mt-4 justify-center">
            <ProjectButtons className="" entry={entry} />
        </div>
        <div class="mt-4 prose prose-invert">
            <Content />
        </div>
    </section>
</Layout>
