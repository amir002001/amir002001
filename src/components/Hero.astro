---
import Link from "./Link.astro";
---

<section
    class="max-sm:hidden text-center z-10 gap-2 absolute top-1/2 left-1/2 flex flex-col justify-center items-center -translate-x-1/2 -translate-y-1/2"
>
    <h1 class="uppercase font-bold text-2xl">Amir Azizafshari</h1>
    <h2 id="subheading" class="font-medium">
        {"use vim btw"}
    </h2>
    <Link href="mainframe" className="mt-4" title="init" />
</section>

<script>
    const subheadings = [
        "terraforming your cloud",
        "can't reach consensus",
        "stuck on a raft",
        "selfie with the zookeper",
        "I am TLS (The Laughing Stock)",
        "docker? I barely know her",
        "use vim btw",
        "chaotic evil engineering",
        "load balancing my mental",
    ];
    function getRandomCharacter() {
        const randomCharCode = Math.floor(Math.random() * (126 - 33 + 1)) + 33;
        return String.fromCharCode(randomCharCode);
    }
    let idx = 0;

    // Function to change the subheading
    function changeSubheading() {
        const subheading = document.getElementById("subheading");
        const newSubheading = subheadings[idx];
        if (idx === subheadings.length - 1) {
            idx = 0;
        } else {
            idx++;
        }

        let displaySubheading = "";
        let i = 0;

        // Create a string with glitch transition effect
        const intervalId = setInterval(() => {
            if (i >= newSubheading.length) {
                clearInterval(intervalId);
                return;
            }

            const randomChar = getRandomCharacter();
            displaySubheading += randomChar;
            subheading!.innerText = displaySubheading;
            setTimeout(() => {
                displaySubheading =
                    displaySubheading.slice(0, -1) + newSubheading[i];
                subheading!.innerText = displaySubheading;
                i++;
            }, 30);
        }, 60);
    }

    // Change the subheading every 5 seconds
    let interval = setInterval(changeSubheading, 5000);
    document.addEventListener("visibilitychange", () => {
        if (document.visibilityState === "hidden") {
            clearInterval(interval);
        } else {
            interval = setInterval(changeSubheading, 5000);
        }
    });
</script>
